<app-unit-schedule-modal *ngIf="openUnitScheduleModal" [mode]="modalMode" [unitsScheduleData]="unitsScheduleData"
  [assetClass]="assetClass" (modalSaveUnitsSchedule)="onCloseUnitScheduleModal($event)"></app-unit-schedule-modal>

  rentFrequencyLabel: {{rentFrequencyLabel}}
<div class="row">
  <div class="col">
    <div class="table" *ngIf="assetClass.investmentStrategy === 'buildToSell'">
      <div class="total-row text-center header bg-grey">
        <div class="table-cell">Total</div>
        <div class="table-cell">{{totalUnits | number: '1.0-0' : 'en-GB'}}</div>
        <div class="table-cell">{{totalAreaSize | number: '1.2-2' : 'en-GB'}}</div>
        <div class="table-cell" *ngIf="unitStructure.hasBeds()">{{totalBeds | number: '1.0-0' : 'en-GB'}}</div>
        <div class="table-cell">{{totalSalePriceTarget | number: '1.0-0' : 'en-GB'}}</div>
        <div class="table-cell">{{totalSalePriceAchieved | number: '1.0-0' : 'en-GB'}}</div>
        <div class="table-cell"></div>
        <div class="table-cell"></div>
      </div>
      <div class="table-row text-center header">
        <div class="table-cell-header pt-2">{{unitStructure.label | titlecase}}</div>
        <div class="table-cell-header pt-2">Description</div>
        <div class="table-cell-header pt-2">{{unitStructure.areaType}} ({{unitStructure.areaSystem}})</div>
        <div class="table-cell-header pt-2" *ngIf="unitStructure.hasBeds()">Beds</div>
        <div class="table-cell-header pt-2">Target price</div>
        <div class="table-cell-header pt-2">Price achieved</div>
        <div class="table-cell-header pt-2">Sale status</div>
        <div class="table-cell-header pt-2">Buyer</div>
      </div>
      <div class="table-row text-center" *ngFor="let unitScheduleData of unitsScheduleData">
        <div class="table-cell">{{unitScheduleData.unit.identifier}}</div>
        <div class="table-cell">{{unitScheduleData.unit.description}}</div>
        <div class="table-cell">{{unitScheduleData.unit.areaSize | number: '1.2-2' : 'en-GB'}}</div>
        <div class="table-cell" *ngIf="unitStructure.hasBeds()">{{unitScheduleData.unit.beds}}</div>
        <div class="table-cell">
          {{unitScheduleData.sale.priceTarget ? unitScheduleData.sale.priceTarget: 'not defined'}}</div>
        <div class="table-cell">
          {{unitScheduleData.sale.priceAchieved ? unitScheduleData.sale.priceAchieved: 'available'}}</div>
        <div class="table-cell">
          
          <ng-container *ngIf="unitScheduleData.sale.status; else noSale">
            {{ unitScheduleData.sale.status }}
            <small>{{ unitScheduleData.sale.statusDate  | date: "dd MMM YYYY"}}</small>
          </ng-container>
          <ng-template #noSale>
            available
          </ng-template>
        
        </div>
        <div class="table-cell">{{unitScheduleData.sale.buyer ? unitScheduleData.sale.buyer: 'available'}}</div>
      </div>
    </div>

    <div class="table" *ngIf="assetClass.investmentStrategy === 'buildToRent'">
      <div class="total-row text-center header bg-grey">
        <div class="table-cell">Total</div>
        <div class="table-cell">{{totalUnits | number: '1.0-0' : 'en-GB'}}</div>
        <div class="table-cell">{{totalAreaSize | number: '1.2-2' : 'en-GB'}}</div>
        <div class="table-cell" *ngIf="unitStructure.hasBeds()">{{totalBeds | number: '1.0-0' : 'en-GB'}}</div>
        <div class="table-cell">{{averageLeaseRentTarget | number: '1.0-0' : 'en-GB'}}</div>
        <div class="table-cell">{{averageLeaseRentAchieved | number: '1.0-0' : 'en-GB'}}</div>
        <div class="table-cell"></div>
        <div class="table-cell"></div>
        <div class="table-cell"></div>
      </div>
      <div class="table-row text-center header">
        <div class="table-cell-header pt-2">{{unitStructure.label | titlecase}}</div>
        <div class="table-cell-header pt-2">Description</div>
        <div class="table-cell-header pt-2">{{unitStructure.areaType}} ({{unitStructure.areaSystem}})</div>
        <div class="table-cell-header pt-2" *ngIf="unitStructure.hasBeds()">Beds</div>
        <div class="table-cell-header pt-2">Rent target <small>({{rentFrequencyLabel}})</small></div>
        <div class="table-cell-header pt-2">Rent achieved <small>({{rentFrequencyLabel}})</small></div>
        <div class="table-cell-header pt-2">Lease start</div>
        <div class="table-cell-header pt-2">Term <small>({{leaseFrequencyLabel}})</small></div>
        <div class="table-cell-header pt-2">Tenant</div>
      </div>
      <div class="table-row text-center" *ngFor="let unitScheduleData of unitsScheduleData">
        <div class="table-cell">{{unitScheduleData.unit.identifier}}</div>
        <div class="table-cell">{{unitScheduleData.unit.description}}</div>
        <div class="table-cell">{{unitScheduleData.unit.areaSize | number: '1.2-2' : 'en-GB'}}</div>
        <div class="table-cell" *ngIf="unitStructure.hasBeds()">{{unitScheduleData.unit.beds}}</div>
        <div class="table-cell">

          <ng-container *ngIf="unitScheduleData.lease.rentTarget; else noRentTarget">
            {{ unitScheduleData.lease.rentTarget }}
            {{ unitScheduleData.lease.rentFrequency }}
          </ng-container>
          <ng-template #noRentTarget>
            available
          </ng-template>

        </div>
        <div class="table-cell">

          <ng-container *ngIf="unitScheduleData.lease.rentAchieved; else noRentAchieved">
            {{ unitScheduleData.lease.rentAchieved }}
            {{ unitScheduleData.lease.rentFrequency }}
          </ng-container>
          <ng-template #noRentAchieved>
            available
          </ng-template>

        </div>
        <div class="table-cell">{{unitScheduleData.lease.startDate ? (unitScheduleData.lease.startDate | date: 'dd MMM YYYY'): 'available'}}
        </div>
        <div class="table-cell">

          <ng-container *ngIf="unitScheduleData.lease.term; else available">
            {{ unitScheduleData.lease.term }}
            {{ unitScheduleData.lease.leaseFrequency }}
          </ng-container>
          <ng-template #available>
            available
          </ng-template>
          
        </div>
        <div class="table-cell">{{unitScheduleData.lease.tenant ? unitScheduleData.lease.tenant: 'available'}}</div>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col">
    <div class="my-2 d-flex justify-content-end">
      <button type="button" class="btn btn-primary mx-2" (click)="onOpenUnitScheduleModal('edit')">Edit unit
        schedule</button>
    </div>
  </div>
</div>
